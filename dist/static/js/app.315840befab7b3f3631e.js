webpackJsonp([0],{"0QIv":function(e,s,t){"use strict";var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"container"},[t("div",{staticClass:"name"}),e._v(" "),t("div",{staticClass:"chatRoom"},[e._m(0),e._v(" "),t("div",{staticClass:"roomBody",attrs:{id:"js-roomBody"}},[e._l(e.messages,function(s){return[s.userName!=e.userName?[t("div",{staticClass:"messageBox"},[t("div",{staticClass:"messageBox__content"},["text"==s.type?t("div",{staticClass:"messageBox__message"},[t("div",{staticClass:"messageBox__text"},[e._v(e._s(s.message))]),e._v(" "),t("div",{staticClass:"messageBox__readMore",on:{click:function(s){e.readMore(s)}}},[e._v("顯示更多")])]):e._e(),e._v(" "),"image"==s.type?t("div",{staticClass:"messageBox__image"},[t("img",{attrs:{src:s.message}})]):e._e()])])]:e._e(),e._v(" "),s.userName==e.userName?[t("div",{staticClass:"messageBox messageBox--self"},[t("div",{staticClass:"messageBox__content"},["text"==s.type?t("div",{staticClass:"messageBox__message"},[t("div",{staticClass:"messageBox__text"},[e._v(e._s(s.message))])]):e._e(),e._v(" "),"image"==s.type?t("div",{staticClass:"messageBox__image"},[t("img",{attrs:{src:s.message}})]):e._e()])])]:e._e()]}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.upload,expression:"upload"}],staticClass:"messageBox messageBox--self"},[t("div",{staticClass:"messageBox__progress"},[t("div",{staticClass:"messageBox__progress--state",attrs:{id:"js-progressBar"}}),e._v(" "),t("div",{staticClass:"messageBox__progress--number"},[e._v(e._s(e.progress))])])])],2),e._v(" "),t("div",{staticClass:"roomBottom",class:{disable:!e.userName}},[t("div",{staticClass:"roomBottom__tools"},[t("div",{staticClass:"roomBottom__tools_upload"},[t("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(s){e.sendImage(s)}}})])]),e._v(" "),t("div",{staticClass:"roomBottom__input"},[t("textarea",{staticClass:"roomBottom__input__textarea",class:{disable:!e.userName},attrs:{id:"js-message"},on:{keydown:function(s){if(!("button"in s)&&e._k(s.keyCode,"enter",13))return null;e.sendMessage(s)}}})])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.userNameSet||""==e.userName,expression:"userNameSet || userName == ''"}],staticClass:"modal"},[t("div",{staticClass:"modal__container"},[e._m(1),e._v(" "),t("div",{staticClass:"modal__body"},[t("input",{staticClass:"userName",attrs:{type:"text",id:"js-userName",maxlength:"6"},domProps:{value:e.userName},on:{keydown:function(s){if(!("button"in s)&&e._k(s.keyCode,"enter",13))return null;e.saveName()}}}),e._v(" "),t("div",{staticClass:"button",on:{click:function(s){e.saveName()}}},[e._v("設定")])]),e._v(" "),t("footer",{staticClass:"modal__footer"})])])])},o=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"roomHead"},[t("div",{staticClass:"roomHead__topButtons"},[t("div",{staticClass:"roomHead__button close"}),e._v(" "),t("div",{staticClass:"roomHead__button minimize"}),e._v(" "),t("div",{staticClass:"roomHead__button zoom"})]),e._v(" "),t("img",{staticClass:"roomHead__img",attrs:{src:"https://lorempixel.com/50/50/",draggable:"false"}}),e._v(" "),t("div",{staticClass:"roomHead__title"},[e._v("Hello There")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("header",{staticClass:"modal__header"},[t("h2",{staticClass:"view-title"},[e._v("輸入名稱")])])}],r={render:a,staticRenderFns:o};s.a=r},Ds4J:function(e,s,t){"use strict";var a=firebase.database().ref("/messages/"),o=firebase.storage().ref("/images/");s.a={name:"ChatRoom",data:function(){return{userNameSet:!1,userName:"",messages:[],upload:!1,progress:""}},methods:{setName:function(){this.userNameSet=!0},saveName:function(){var e=this,s=document.querySelector("#js-userName").value;""!=s.trim()&&(e.userName=s,e.userNameSet=!1)},getTime:function(){var e=new Date,s=e.getHours(),t=e.getMinutes();return(s>=12?"下午":"上午")+" "+s+":"+(t<10?"0"+t:t)},sendMessage:function(e){var s=this,t=document.querySelector("#js-userName"),o=document.querySelector("#js-message");return!e.shiftKey&&(o.value.length<=1&&""==o.value.trim()?(e.preventDefault(),!1):(a.push({userName:t.value,type:"text",message:o.value,timeStamp:s.getTime()}),o.value="",void e.preventDefault()))},sendImage:function(e){var s=this,t=document.querySelector("#js-userName"),r=e.target.files[0],i=Math.floor(Date.now()/1e3)+"_"+r.name,n={contentType:"image/*"},u=document.querySelector("#js-progressBar"),m=o.child(i).put(r,n);m.on(firebase.storage.TaskEvent.STATE_CHANGED,function(e){var t=Math.floor(e.bytesTransferred/e.totalBytes*100);t<100&&(s.upload=!0,s.progress=t+"%",u.setAttribute("style","width:"+t+"%"))},function(e){a.child("bug/").push({userName:t.value,type:"image",message:e.code,timeStamp:s.getTime()})},function(){var e=m.snapshot.downloadURL;a.push({userName:t.value,type:"image",message:e,timeStamp:s.getTime()}),s.upload=!1})},readMore:function(e){e.target.previousElementSibling.setAttribute("style","max-height: 100%;"),e.target.setAttribute("style","display: none;")}},mounted:function(){var e=this;a.on("value",function(s){var t=s.val();e.messages=t})},updated:function(){document.querySelectorAll(".messageBox__message").forEach(function(e){e.offsetHeight>300&&e.querySelector(".messageBox__readMore").setAttribute("style","display: block")});var e=document.querySelector("#js-roomBody");e.scrollTop=e.scrollHeight}}},M93x:function(e,s,t){"use strict";function a(e){t("uaQU")}var o=t("xJD8"),r=t("VPST"),i=t("VU/8"),n=a,u=i(o.a,r.a,n,null,null);s.a=u.exports},NHnr:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("7+uW"),o=t("M93x"),r=t("YaEn");a.a.config.productionTip=!1,new a.a({el:"#app",router:r.a,template:"<App/>",components:{App:o.a}})},RFZe:function(e,s,t){"use strict";function a(e){t("bDub")}var o=t("Ds4J"),r=t("0QIv"),i=t("VU/8"),n=a,u=i(o.a,r.a,n,"data-v-1b1d2a11",null);s.a=u.exports},VPST:function(e,s,t){"use strict";var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],r={render:a,staticRenderFns:o};s.a=r},YaEn:function(e,s,t){"use strict";var a=t("7+uW"),o=t("/ocq"),r=t("RFZe");a.a.use(o.a),s.a=new o.a({routes:[{path:"/",name:"ChatRoom",component:r.a}]})},bDub:function(e,s){},uaQU:function(e,s){},xJD8:function(e,s,t){"use strict";s.a={name:"app"}}},["NHnr"]);
//# sourceMappingURL=app.315840befab7b3f3631e.js.map